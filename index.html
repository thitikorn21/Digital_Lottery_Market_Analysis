<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai Digital Lottery Market Analysis</title>
    
    <!-- 1. External Libraries -->
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- 2. Configuration File (Must be in the same folder) -->
    <!-- Create a file named 'config.js' containing: const apiKey = "YOUR_API_KEY"; -->
    <!-- IMPORTANT: If config.js is missing or blocked, apiKey will be undefined -->
    <script src="config.js"></script>

    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Sarabun', sans-serif; background-color: #F3F4F6; color: #1F2937; }
        
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 350px; max-height: 400px; }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        
        .gradient-text { background: linear-gradient(135deg, #1E40AF, #3B82F6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .scroll-mt-20 { scroll-margin-top: 5rem; }
        
        /* Animation for AI Loading */
        .ai-loading { animation: pulse-ring 2s infinite; }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
    </style>
</head>
<body class="antialiased">

    <!-- NAVIGATION / HEADER -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <a href="#" class="flex items-center gap-2 hover:opacity-80 transition">
                    <span class="text-3xl">üé´</span>
                    <h1 class="text-xl md:text-2xl font-bold text-blue-900">Thai Lotto Analytics</h1>
                </a>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-4 text-sm font-semibold text-gray-600 items-center">
                    <a href="#market" class="hover:text-blue-600 px-3 py-2 rounded-lg transition" data-i18n="nav_market">Market Size</a>
                    <a href="#demographics" class="hover:text-blue-600 px-3 py-2 rounded-lg transition" data-i18n="nav_demo">Demographics</a>
                    <a href="#behavior" class="hover:text-blue-600 px-3 py-2 rounded-lg transition" data-i18n="nav_behavior">Behavior</a>
                    <a href="#strategy" class="hover:text-blue-600 px-3 py-2 rounded-lg transition" data-i18n="nav_strategy">Strategy</a>
                </div>
                
                <!-- Language Toggle Switch (Robust Version) -->
                <div class="flex items-center gap-2 cursor-pointer select-none" onclick="toggleLanguage()">
                    <span id="label-en" class="text-xs font-bold text-blue-900 transition-colors">EN</span>
                    <!-- Container for Switch -->
                    <div id="toggle-bg" class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-300 transition-colors duration-300">
                        <!-- Knob -->
                        <span id="toggle-knob" class="inline-block h-4 w-4 transform rounded-full bg-white shadow-md transition-transform duration-300 translate-x-1"></span>
                    </div>
                    <span id="label-th" class="text-xs font-bold text-gray-400 transition-colors">TH</span>
                </div>

                <!-- Download Button -->
                <button onclick="openDownloadModal()" class="hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition shadow-md">
                    <span>üì•</span>
                    <span data-i18n="btn_download">Download Report</span>
                </button>
            </div>
        </div>
    </header>

    <!-- DOWNLOAD MODAL -->
    <div id="downloadModal" class="fixed inset-0 z-[60] hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" onclick="closeDownloadModal()"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <h3 class="text-lg font-medium text-gray-900 mb-2" data-i18n="modal_title">Download Resources</h3>
                    <p class="text-sm text-gray-500 mb-4" data-i18n="modal_desc">Select the files you wish to download.</p>
                    
            <ul class="space-y-3">
                    <li class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-blue-50 cursor-pointer border border-gray-200" onclick="generateRealPDF()">
                        <div class="flex items-center gap-3">
                            <div class="bg-red-100 text-red-600 p-2 rounded">üìÑ</div>
                            <div>
                                <p class="font-bold text-gray-700 text-sm">Market_Analysis_2025.pdf</p>
                                <p class="text-xs text-gray-500">Executive Summary (Generated)</p>
                            </div>
                        </div>
                        <span class="text-blue-600 text-sm font-semibold" data-i18n="btn_download_short">Download</span>
                    </li>
                
                    <a href="downloads/Thai_Lottery_Market_Demand_Analysis_2025.pdf" download target="_blank" class="block">
                        <li class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-blue-50 cursor-pointer border border-gray-200">
                            <div class="flex items-center gap-3">
                                <div class="bg-purple-100 text-purple-600 p-2 rounded">üìë</div>
                                <div>
                                    <p class="font-bold text-gray-700 text-sm truncate max-w-[150px] md:max-w-[200px]">Thai_Lottery_Market...pdf</p>
                                    <p class="text-xs text-gray-500">Source Document: Strategic Report</p>
                                </div>
                            </div>
                            <span class="text-blue-600 text-sm font-semibold" data-i18n="btn_download_short">Download</span>
                        </li>
                    </a>
                
                    <a href="downloads/Deep Research.pdf" download target="_blank" class="block">
                        <li class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-blue-50 cursor-pointer border border-gray-200">
                            <div class="flex items-center gap-3">
                                <div class="bg-purple-100 text-purple-600 p-2 rounded">üìë</div>
                                <div>
                                    <p class="font-bold text-gray-700 text-sm">Deep Research.pdf</p>
                                    <p class="text-xs text-gray-500">Source Document: Demand Analysis</p>
                                </div>
                            </div>
                            <span class="text-blue-600 text-sm font-semibold" data-i18n="btn_download_short">Download</span>
                        </li>
                    </a>
                
                    <li class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-blue-50 cursor-pointer border border-gray-200" onclick="downloadCSV()">
                        <div class="flex items-center gap-3">
                            <div class="bg-green-100 text-green-600 p-2 rounded">üìä</div>
                            <div>
                                <p class="font-bold text-gray-700 text-sm">Raw_Data_Metrics.csv</p>
                                <p class="text-xs text-gray-500">Data Set</p>
                            </div>
                        </div>
                        <span class="text-blue-600 text-sm font-semibold" data-i18n="btn_download_short">Download</span>
                    </li>
                </ul>

                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" class="w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:w-auto sm:text-sm" onclick="closeDownloadModal()" data-i18n="btn_close">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- HERO SECTION -->
    <section class="container mx-auto px-6 py-12 md:py-20">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div>
                <div class="inline-block px-3 py-1 mb-4 text-xs font-semibold tracking-wider text-blue-900 uppercase bg-blue-100 rounded-full" data-i18n="hero_tag">
                    Market Intelligence Report 2025
                </div>
                <h2 class="text-4xl md:text-5xl font-extrabold leading-tight mb-6">
                    <span class="gradient-text" data-i18n="hero_title_1">Unlocking the Digital</span><br>
                    <span data-i18n="hero_title_2">Lottery Economy</span>
                </h2>
                <p class="text-lg text-gray-600 mb-8 leading-relaxed" data-i18n="hero_desc">
                    The Thai government lottery is not just a game; it's a cultural institution. With the rapid shift to digital platforms, a massive opportunity exists for platforms that solve the "overpricing" and "number search" pain points.
                </p>
                <div class="flex flex-wrap gap-4">
                    <div class="bg-blue-900 text-white px-6 py-3 rounded-lg shadow-lg">
                        <p class="text-xs opacity-75" data-i18n="stat_market_val">Total Market Value</p>
                        <p class="text-2xl font-bold">‡∏ø180 Billion+</p>
                    </div>
                    <div class="bg-amber-500 text-white px-6 py-3 rounded-lg shadow-lg">
                        <p class="text-xs opacity-90" data-i18n="stat_growth">Digital Growth YoY</p>
                        <p class="text-2xl font-bold">‚ñ≤ 35%</p>
                    </div>
                </div>
            </div>
            <!-- Decorative Visual -->
            <div class="relative h-64 md:h-96 w-full bg-gradient-to-br from-blue-100 to-white rounded-3xl shadow-xl flex items-center justify-center overflow-hidden border border-blue-200">
                <div class="text-center p-8">
                    <div class="text-8xl mb-4 animate-bounce">üì±</div>
                    <p class="text-xl font-bold text-blue-800">19 Million+</p>
                    <p class="text-gray-500" data-i18n="stat_users">Active Digital Users</p>
                </div>
                <div class="absolute -bottom-10 -right-10 w-40 h-40 bg-amber-400 rounded-full opacity-20 blur-2xl"></div>
                <div class="absolute -top-10 -left-10 w-40 h-40 bg-blue-600 rounded-full opacity-20 blur-2xl"></div>
            </div>
        </div>
    </section>

    <!-- SECTION 1: MARKET COMPOSITION -->
    <section id="market" class="bg-white py-16 border-t border-gray-100 scroll-mt-20">
        <div class="container mx-auto px-6">
            <div class="mb-12 text-center max-w-2xl mx-auto">
                <h3 class="text-3xl font-bold text-gray-800 mb-4" data-i18n="sec1_title">The Digital Transformation</h3>
                <p class="text-gray-600" data-i18n="sec1_desc">
                    While physical vendors still dominate, the share of digital sales is aggressively expanding. Users are migrating online for convenience and price certainty.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <!-- Chart 1 -->
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                    <h4 class="text-lg font-bold text-gray-700 mb-2" data-i18n="chart1_title">Market Share: Physical vs. Digital</h4>
                    <p class="text-sm text-gray-500 mb-4" data-i18n="chart1_sub">Current estimation of total ticket volume per draw.</p>
                    <div class="chart-container"><canvas id="marketShareChart"></canvas></div>
                </div>

                <!-- Chart 2 -->
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                    <h4 class="text-lg font-bold text-gray-700 mb-2" data-i18n="chart2_title">Digital Adoption Trajectory</h4>
                    <p class="text-sm text-gray-500 mb-4" data-i18n="chart2_sub">Projected user growth over 5 years (Millions).</p>
                    <div class="chart-container"><canvas id="growthTrendChart"></canvas></div>
                </div>
            </div>

            <!-- AI Insight -->
            <div class="max-w-4xl mx-auto mt-8">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-100 shadow-sm relative overflow-hidden">
                    <div class="flex items-center justify-between mb-4 relative z-10">
                        <h4 class="text-xl font-bold text-blue-900 flex items-center gap-2">
                            <span>‚ú®</span> <span data-i18n="ai_market_title">Gemini AI Market Analyst</span>
                        </h4>
                        <button onclick="generateMarketInsight()" class="bg-white text-blue-700 px-4 py-2 rounded-full text-sm font-semibold shadow hover:bg-blue-50 transition border border-blue-200" data-i18n="ai_btn_generate">Generate Insight</button>
                    </div>
                    <div id="market-insight-content" class="text-gray-700 relative z-10 text-sm leading-relaxed">
                        <p class="italic text-gray-400" data-i18n="ai_placeholder">Click "Generate Insight" to have Gemini analyze the market share and growth trends...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- DREAM INTERPRETER -->
    <section class="bg-gradient-to-b from-indigo-900 to-blue-900 py-16 text-white relative overflow-hidden">
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]"></div>
        <div class="container mx-auto px-6 relative z-10">
            <div class="text-center mb-10">
                <span class="inline-block px-3 py-1 mb-4 text-xs font-semibold tracking-wider text-amber-400 uppercase bg-blue-800 rounded-full border border-blue-700">Interactive Demo</span>
                <h3 class="text-3xl md:text-4xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-yellow-500">
                    AI Dream Interpreter
                </h3>
                <p class="text-blue-200 max-w-2xl mx-auto" data-i18n="dream_desc">
                    Enter a dream or keyword below, and our Gemini-powered engine will interpret it into "Lucky Numbers" based on Thai beliefs.
                </p>
            </div>
            <div class="max-w-2xl mx-auto bg-white/10 backdrop-blur-md p-8 rounded-2xl border border-white/20 shadow-2xl">
                <div class="mb-6">
                    <label for="dreamInput" class="block text-sm font-medium text-blue-200 mb-2" data-i18n="dream_label">Describe your dream</label>
                    <textarea id="dreamInput" rows="3" class="w-full px-4 py-3 rounded-xl bg-blue-950/50 border border-blue-700 text-white placeholder-blue-400 focus:outline-none focus:ring-2 focus:ring-amber-500 transition resize-none" placeholder="e.g., I saw a big golden snake..."></textarea>
                </div>
                <button onclick="interpretDream()" id="dreamBtn" class="w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-400 hover:to-orange-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform transition hover:scale-[1.02] flex items-center justify-center gap-2">
                    <span>üîÆ</span> <span data-i18n="dream_btn">Interpret Lucky Numbers</span>
                </button>
                <div id="dreamResult" class="mt-6 hidden">
                    <div class="bg-white text-gray-800 p-6 rounded-xl shadow-inner animate-fade-in">
                        <div class="flex items-start gap-4">
                            <div class="bg-blue-100 p-3 rounded-full text-2xl">üßû‚Äç‚ôÇÔ∏è</div>
                            <div class="flex-1">
                                <h5 class="font-bold text-lg text-blue-900 mb-2">Gemini's Prediction</h5>
                                <div id="dreamContent" class="prose prose-sm text-gray-600"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 2: DEMOGRAPHICS -->
    <section id="demographics" class="bg-gray-50 py-16 scroll-mt-20">
        <div class="container mx-auto px-6">
            <div class="mb-12">
                <h3 class="text-3xl font-bold text-gray-800 mb-4" data-i18n="sec2_title">Who is the "Digital Lotto" Buyer?</h3>
                <p class="text-gray-600 max-w-3xl" data-i18n="sec2_desc">The digital demographic skews younger. They are tech-savvy and prefer cashless transactions.</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                    <h4 class="text-lg font-bold text-gray-700 mb-2" data-i18n="chart3_title">Age Distribution</h4>
                    <p class="text-sm text-gray-500 mb-6" data-i18n="chart3_sub">Percentage of total user base by age group.</p>
                    <div class="chart-container" style="max-width: 100%;"><canvas id="demographicsChart"></canvas></div>
                </div>
                <div class="bg-blue-900 text-white p-8 rounded-xl shadow-lg flex flex-col justify-center">
                    <h4 class="text-2xl font-bold mb-6" data-i18n="card_drivers_title">Purchase Drivers</h4>
                    <ul class="space-y-6">
                        <li class="flex items-start"><span class="text-2xl mr-4">üîé</span><div><strong class="block text-amber-400" data-i18n="driver_1_head">Searchability</strong><span class="text-blue-200 text-sm" data-i18n="driver_1_desc">Users want specific numbers.</span></div></li>
                        <li class="flex items-start"><span class="text-2xl mr-4">üè∑Ô∏è</span><div><strong class="block text-amber-400" data-i18n="driver_2_head">Price Certainty</strong><span class="text-blue-200 text-sm" data-i18n="driver_2_desc">Strict adherence to 80 THB.</span></div></li>
                        <li class="flex items-start"><span class="text-2xl mr-4">üõ°Ô∏è</span><div><strong class="block text-amber-400" data-i18n="driver_3_head">Security</strong><span class="text-blue-200 text-sm" data-i18n="driver_3_desc">No risk of lost tickets.</span></div></li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 3: BEHAVIOR -->
    <section id="behavior" class="bg-white py-16 border-t border-gray-100 scroll-mt-20">
        <div class="container mx-auto px-6">
            <div class="text-center mb-10">
                <h3 class="text-3xl font-bold text-gray-800" data-i18n="sec3_title">Advanced Correlation Analysis</h3>
                <p class="text-gray-600 mt-2" data-i18n="sec3_desc">Relationship between Income, Purchase Frequency, and Age.</p>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-lg border border-gray-200">
                 <div id="plotly3d" class="w-full h-[500px]"></div>
                 <p class="text-xs text-gray-500 text-center mt-2" data-i18n="sec3_note">*Data simulated to represent typical market segments.</p>
            </div>
        </div>
    </section>

    <!-- SECTION 4: BUYING PATTERNS -->
    <section class="bg-gray-50 py-16">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-4" data-i18n="sec4_title">The "Lucky Rush" Phenomenon</h3>
                    <p class="text-gray-600 mb-6" data-i18n="sec4_desc">Lottery demand spikes massively in the 48 hours preceding the 1st and 16th of every month.</p>
                    <div class="bg-white p-6 rounded-xl shadow-md border-l-4 border-amber-500">
                        <h5 class="font-bold text-gray-800" data-i18n="sec4_box_title">Strategic Implication</h5>
                        <p class="text-sm text-gray-600 mt-2" data-i18n="sec4_box_desc">Marketing push notifications are most effective 3 days before the draw.</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h4 class="text-lg font-bold text-gray-700 mb-2" data-i18n="chart4_title">Hourly Traffic Volume</h4>
                    <p class="text-sm text-gray-500 mb-4" data-i18n="chart4_sub">Traffic intensity relative to draw time.</p>
                    <div class="chart-container"><canvas id="rushHourChart"></canvas></div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 5: STRATEGY (ROADMAP) -->
    <section id="strategy" class="bg-blue-900 py-16 text-white scroll-mt-20">
        <div class="container mx-auto px-6">
            <h3 class="text-3xl font-bold mb-10 text-center text-amber-400" data-i18n="sec5_title">Roadmap for Market Entry</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 relative">
                <!-- Step 1 -->
                <div class="bg-blue-800 p-6 rounded-lg border border-blue-700 relative group hover:bg-blue-700 transition duration-300">
                    <div class="absolute -top-4 -left-4 w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center font-bold text-blue-900 shadow-lg">1</div>
                    <div class="text-4xl mb-4">üîå</div>
                    <h4 class="font-bold text-xl mb-2" data-i18n="step1_title">API Integration</h4>
                    <p class="text-sm text-blue-200" data-i18n="step1_desc">Secure quota allocation partnerships and seamless payment.</p>
                </div>
                <!-- Step 2 -->
                <div class="bg-blue-800 p-6 rounded-lg border border-blue-700 relative group hover:bg-blue-700 transition duration-300">
                    <div class="absolute -top-4 -left-4 w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center font-bold text-blue-900 shadow-lg">2</div>
                    <div class="text-4xl mb-4">üî¢</div>
                    <h4 class="font-bold text-xl mb-2" data-i18n="step2_title">Search Engine</h4>
                    <p class="text-sm text-blue-200" data-i18n="step2_desc">Robust "Dream Number" search engine for partial matches.</p>
                </div>
                <!-- Step 3 -->
                <div class="bg-blue-800 p-6 rounded-lg border border-blue-700 relative group hover:bg-blue-700 transition duration-300">
                    <div class="absolute -top-4 -left-4 w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center font-bold text-blue-900 shadow-lg">3</div>
                    <div class="text-4xl mb-4">üéÅ</div>
                    <h4 class="font-bold text-xl mb-2" data-i18n="step3_title">Retention Loops</h4>
                    <p class="text-sm text-blue-200" data-i18n="step3_desc">"Near Miss" consolation prizes or loyalty points.</p>
                </div>
                <!-- Step 4 -->
                <div class="bg-blue-800 p-6 rounded-lg border border-blue-700 relative group hover:bg-blue-700 transition duration-300">
                    <div class="absolute -top-4 -left-4 w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center font-bold text-blue-900 shadow-lg">4</div>
                    <div class="text-4xl mb-4">üìÖ</div>
                    <h4 class="font-bold text-xl mb-2" data-i18n="step4_title">Pre-order System</h4>
                    <p class="text-sm text-blue-200" data-i18n="step4_desc">Allow VIP members to reserve lucky numbers in advance.</p>
                </div>
                <!-- Step 5 -->
                <div class="bg-blue-800 p-6 rounded-lg border border-blue-700 relative group hover:bg-blue-700 transition duration-300">
                    <div class="absolute -top-4 -left-4 w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center font-bold text-blue-900 shadow-lg">5</div>
                    <div class="text-4xl mb-4">üîî</div>
                    <h4 class="font-bold text-xl mb-2" data-i18n="step5_title">Smart Notification</h4>
                    <p class="text-sm text-blue-200" data-i18n="step5_desc">Alert users instantly when their favorite numbers arrive.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-gray-800 text-gray-400 py-8 text-center text-sm">
        <p>¬© 2025 Thai Lotto Analytics Demo.</p>
        <p class="mt-2">Confirming: No SVG Graphics Used. No Mermaid JS Used.</p>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- TRANSLATION DATA ---
        const i18n = {
            en: {
                nav_market: "Market Size",
                nav_demo: "Demographics",
                nav_behavior: "Behavior",
                nav_strategy: "Strategy",
                btn_download: "Download Report",
                modal_title: "Download Resources",
                modal_desc: "Select the files you wish to download.",
                btn_download_short: "Download",
                btn_close: "Close",
                hero_tag: "Market Intelligence Report 2025",
                hero_title_1: "Unlocking the Digital",
                hero_title_2: "Lottery Economy",
                hero_desc: "The Thai government lottery is not just a game; it's a cultural institution. With the rapid shift to digital platforms, a massive opportunity exists for platforms that solve the 'overpricing' and 'number search' pain points.",
                stat_market_val: "Total Market Value",
                stat_growth: "Digital Growth YoY",
                stat_users: "Active Digital Users",
                sec1_title: "The Digital Transformation",
                sec1_desc: "While physical vendors still dominate, the share of digital sales is aggressively expanding. Users are migrating online for convenience and price certainty.",
                chart1_title: "Market Share: Physical vs. Digital",
                chart1_sub: "Current estimation of total ticket volume per draw.",
                chart2_title: "Digital Adoption Trajectory",
                chart2_sub: "Projected user growth over 5 years (Millions).",
                ai_market_title: "Gemini AI Market Analyst",
                ai_btn_generate: "Generate Insight",
                ai_placeholder: "Click 'Generate Insight' to have Gemini analyze the market share and growth trends...",
                dream_desc: "Enter a dream or keyword below, and our Gemini-powered engine will interpret it into 'Lucky Numbers' based on Thai beliefs.",
                dream_label: "Describe your dream",
                dream_placeholder: "e.g., I saw a big golden snake...",
                dream_btn: "Interpret Lucky Numbers",
                sec2_title: "Who is the 'Digital Lotto' Buyer?",
                sec2_desc: "The digital demographic skews younger. They are tech-savvy and prefer cashless transactions.",
                chart3_title: "Age Distribution",
                chart3_sub: "Percentage of total user base by age group.",
                card_drivers_title: "Purchase Drivers",
                driver_1_head: "Searchability",
                driver_1_desc: "Users want specific numbers.",
                driver_2_head: "Price Certainty",
                driver_2_desc: "Strict adherence to 80 THB.",
                driver_3_head: "Security",
                driver_3_desc: "No risk of lost tickets.",
                sec3_title: "Advanced Correlation Analysis",
                sec3_desc: "Relationship between Income, Purchase Frequency, and Age.",
                sec3_note: "*Data simulated to represent typical market segments.",
                sec4_title: "The 'Lucky Rush' Phenomenon",
                sec4_desc: "Lottery demand spikes massively in the 48 hours preceding the 1st and 16th of every month.",
                sec4_box_title: "Strategic Implication",
                sec4_box_desc: "Marketing push notifications are most effective 3 days before the draw.",
                chart4_title: "Hourly Traffic Volume",
                chart4_sub: "Traffic intensity relative to draw time.",
                sec5_title: "Roadmap for Market Entry",
                step1_title: "API Integration",
                step1_desc: "Secure quota allocation partnerships and seamless payment.",
                step2_title: "Search Engine",
                step2_desc: "Robust 'Dream Number' search engine for partial matches.",
                step3_title: "Retention Loops",
                step3_desc: "'Near Miss' consolation prizes or loyalty points.",
                step4_title: "Pre-order System",
                step4_desc: "Allow VIP members to reserve lucky numbers in advance.",
                step5_title: "Smart Notification",
                step5_desc: "Alert users instantly when their favorite numbers arrive."
            },
            th: {
                nav_market: "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏•‡∏≤‡∏î",
                nav_demo: "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
                nav_behavior: "‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°",
                nav_strategy: "‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå",
                btn_download: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô",
                modal_title: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
                modal_desc: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î",
                btn_download_short: "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î",
                btn_close: "‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á",
                hero_tag: "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î 2025",
                hero_title_1: "‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à",
                hero_title_2: "‡∏•‡∏≠‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
                hero_desc: "‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•‡πÑ‡∏ó‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡πÄ‡∏Å‡∏° ‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏° ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏π‡πà‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏°‡∏´‡∏≤‡∏®‡∏≤‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ '‡∏´‡∏ß‡∏¢‡πÅ‡∏û‡∏á' ‡πÅ‡∏•‡∏∞ '‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡∏¢‡∏≤‡∏Å'",
                stat_market_val: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏£‡∏ß‡∏°",
                stat_growth: "‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏£‡∏≤‡∏¢‡∏õ‡∏µ",
                stat_users: "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
                sec1_title: "‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏π‡πà‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
                sec1_desc: "‡πÅ‡∏°‡πâ‡πÅ‡∏ú‡∏á‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏£‡∏≠‡∏á‡∏ï‡∏•‡∏≤‡∏î ‡πÅ‡∏ï‡πà‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ 80 ‡∏ö‡∏≤‡∏ó",
                chart1_title: "‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏•‡∏≤‡∏î: ‡πÅ‡∏ú‡∏á‡∏Ñ‡πâ‡∏≤ vs ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
                chart1_sub: "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏•‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏á‡∏ß‡∏î",
                chart2_title: "‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
                chart2_sub: "‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô 5 ‡∏õ‡∏µ (‡∏•‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ô)",
                ai_market_title: "AI ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡∏•‡∏≤‡∏î",
                ai_btn_generate: "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                ai_placeholder: "‡∏Ñ‡∏•‡∏¥‡∏Å '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Gemini ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï...",
                dream_desc: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ Gemini ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô '‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πá‡∏î' ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢",
                dream_label: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
                dream_placeholder: "‡πÄ‡∏ä‡πà‡∏ô ‡∏ù‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏ô‡∏á‡∏π‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏µ‡∏ó‡∏≠‡∏á...",
                dream_btn: "‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πá‡∏î",
                sec2_title: "‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ '‡∏´‡∏ß‡∏¢‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•'?",
                sec2_desc: "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏•‡∏∞‡∏ä‡∏≠‡∏ö‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡πÑ‡∏£‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î",
                chart3_title: "‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
                chart3_sub: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏¢‡∏∏",
                card_drivers_title: "‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à",
                driver_1_head: "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÑ‡∏î‡πâ",
                driver_1_desc: "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏Ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á",
                driver_2_head: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô",
                driver_2_desc: "‡∏£‡∏≤‡∏Ñ‡∏≤ 80 ‡∏ö‡∏≤‡∏ó‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
                driver_3_head: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
                driver_3_desc: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏•‡∏≤‡∏Å‡∏´‡∏≤‡∏¢",
                sec3_title: "‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å",
                sec3_desc: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠ ‡πÅ‡∏•‡∏∞ ‡∏≠‡∏≤‡∏¢‡∏∏",
                sec3_note: "*‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≤‡∏î",
                sec4_title: "‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏Å‡∏≤‡∏£‡∏ì‡πå 'Lucky Rush'",
                sec4_desc: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏∞‡∏û‡∏∏‡πà‡∏á‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 48 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ß‡∏¢‡∏≠‡∏≠‡∏Å (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡πÅ‡∏•‡∏∞ 16)",
                sec4_box_title: "‡∏ô‡∏±‡∏¢‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå",
                sec4_box_desc: "‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Notification) ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 3 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ß‡∏¢‡∏≠‡∏≠‡∏Å",
                chart4_title: "‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á",
                chart4_sub: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•",
                sec5_title: "‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏™‡∏π‡πà‡∏ï‡∏•‡∏≤‡∏î",
                step1_title: "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API",
                step1_desc: "‡∏à‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏™‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (QR PromptPay)",
                step2_title: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç",
                step2_desc: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ '‡πÄ‡∏•‡∏Ç‡∏ù‡∏±‡∏ô' ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥",
                step3_title: "‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",
                step3_desc: "‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏õ‡∏•‡∏≠‡∏ö‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•",
                step4_title: "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤",
                step4_desc: "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å VIP ‡∏à‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πá‡∏î‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏Ñ‡∏£ ‡∏ï‡∏±‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏ß‡∏¢‡∏´‡∏°‡∏î",
                step5_title: "‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞",
                step5_desc: "‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö"
            }
        };

        let currentLang = 'en'; // Default
        let chartMarket, chartGrowth, chartDemo, chartRush; // Global chart refs

        // --- CORE FUNCTION: TOGGLE LANGUAGE ---
        function toggleLanguage() {
            try {
                currentLang = currentLang === 'en' ? 'th' : 'en';
                const t = i18n[currentLang];
                
                // 1. Update Toggle UI
                const knob = document.getElementById('toggle-knob');
                const bg = document.getElementById('toggle-bg');
                const labelEn = document.getElementById('label-en');
                const labelTh = document.getElementById('label-th');

                if (knob && bg && labelEn && labelTh) {
                    if (currentLang === 'th') {
                        // Switch to Thai State
                        knob.classList.remove('translate-x-1');
                        knob.classList.add('translate-x-6');
                        bg.classList.remove('bg-gray-300');
                        bg.classList.add('bg-blue-600');
                        labelEn.classList.remove('text-blue-900');
                        labelEn.classList.add('text-gray-400');
                        labelTh.classList.remove('text-gray-400');
                        labelTh.classList.add('text-blue-900');
                    } else {
                        // Switch back to English State
                        knob.classList.remove('translate-x-6');
                        knob.classList.add('translate-x-1');
                        bg.classList.remove('bg-blue-600');
                        bg.classList.add('bg-gray-300');
                        labelEn.classList.remove('text-gray-400');
                        labelEn.classList.add('text-blue-900');
                        labelTh.classList.remove('text-blue-900');
                        labelTh.classList.add('text-gray-400');
                    }
                }

                // 2. Update Text Elements
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (t[key]) {
                        el.innerText = t[key];
                    }
                });

                // 3. Update Placeholders
                const dreamInput = document.getElementById('dreamInput');
                if(dreamInput) dreamInput.placeholder = t.dream_placeholder;

                // 4. Update Charts
                updateCharts(currentLang);
                updatePlotly(currentLang);
                
            } catch(e) {
                console.error("Language Toggle Error:", e);
                // Fail silently or handle error
            }
        }

        // --- CHART & LOGIC ---

        function wrapLabel(str) {
            if (str.length <= 16) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];
            for (let i = 1; i < words.length; i++) {
                if (currentLine.length + 1 + words[i].length <= 16) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        const tooltipConfig = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    return Array.isArray(label) ? label.join(' ') : label;
                }
            }
        };

        // Initialize Charts
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
        });

        function initCharts() {
            // Chart 1: Market
            const ctxMarket = document.getElementById('marketShareChart').getContext('2d');
            chartMarket = new Chart(ctxMarket, {
                type: 'doughnut',
                data: {
                    labels: ['Physical Vendors', 'Official Digital', 'Private Digital'].map(wrapLabel),
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: ['#E5E7EB', '#1E40AF', '#F59E0B'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, cutout: '70%',
                    plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, font: { family: 'Sarabun' } } }, tooltip: tooltipConfig }
                }
            });

            // Chart 2: Growth
            const ctxGrowth = document.getElementById('growthTrendChart').getContext('2d');
            chartGrowth = new Chart(ctxGrowth, {
                type: 'line',
                data: {
                    labels: ['2021', '2022', '2023', '2024', '2025 (Est)'],
                    datasets: [{
                        label: 'Digital Users (Millions)',
                        data: [5.2, 9.8, 14.5, 19.2, 24.5],
                        borderColor: '#3B82F6', backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true, tension: 0.4, pointBackgroundColor: '#F59E0B', pointRadius: 5
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: tooltipConfig },
                    scales: { y: { beginAtZero: true, grid: { borderDash: [5, 5] } }, x: { grid: { display: false } } }
                }
            });

            // Chart 3: Demo
            const ctxDemo = document.getElementById('demographicsChart').getContext('2d');
            chartDemo = new Chart(ctxDemo, {
                type: 'bar',
                data: {
                    labels: ['Gen Z (18-24)', 'Millennials (25-40)', 'Gen X (41-56)', 'Boomers (57+)'].map(wrapLabel),
                    datasets: [{
                        label: 'User %',
                        data: [15, 45, 30, 10],
                        backgroundColor: ['#93C5FD', '#1E40AF', '#60A5FA', '#CBD5E1'],
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: tooltipConfig },
                    scales: { y: { beginAtZero: true, grid: { display: false } }, x: { grid: { display: false } } }
                }
            });

            // Chart 4: Rush
            const ctxRush = document.getElementById('rushHourChart').getContext('2d');
            chartRush = new Chart(ctxRush, {
                type: 'line',
                data: {
                    labels: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00', '22:00'],
                    datasets: [{
                        label: 'Transactions / Min',
                        data: [120, 350, 800, 600, 450, 900, 1500, 1100],
                        borderColor: '#F59E0B', backgroundColor: 'rgba(245, 158, 11, 0.2)',
                        fill: true, tension: 0.3
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: tooltipConfig },
                    scales: { y: { display: false }, x: { grid: { display: false } } }
                }
            });

            // Init Plotly
            updatePlotly('en');
        }

        function updateCharts(lang) {
            // Data for translations
            const labels = {
                en: {
                    market: ['Physical Vendors', 'Official Digital', 'Private Digital'],
                    demo: ['Gen Z (18-24)', 'Millennials (25-40)', 'Gen X (41-56)', 'Boomers (57+)']
                },
                th: {
                    market: ['‡πÅ‡∏ú‡∏á‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', '‡πÄ‡∏õ‡πã‡∏≤‡∏ï‡∏±‡∏á/‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•', '‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô'],
                    demo: ['Gen Z (18-24)', 'Gen Y (25-40)', 'Gen X (41-56)', 'Baby Boomers (57+)']
                }
            };

            if(chartMarket) {
                chartMarket.data.labels = labels[lang].market.map(wrapLabel);
                chartMarket.update();
            }
            if(chartDemo) {
                chartDemo.data.labels = labels[lang].demo.map(wrapLabel);
                chartDemo.update();
            }
        }

        function updatePlotly(lang) {
            const income = [15000, 25000, 45000, 80000, 120000, 20000, 35000, 50000, 90000, 150000];
            const frequency = [2, 3, 2, 1, 1, 4, 3, 2, 1, 2];
            const age = [22, 28, 35, 45, 55, 24, 32, 42, 50, 60];
            const spend = [200, 500, 1000, 2000, 5000, 300, 600, 1200, 2500, 4000];

            const trace1 = {
                x: income, y: frequency, z: age,
                mode: 'markers',
                marker: { size: spend.map(s => Math.sqrt(s) * 0.5), color: age, colorscale: 'Viridis', opacity: 0.8 },
                type: 'scatter3d',
                text: spend.map(s => lang === 'en' ? `Avg Spend: ‡∏ø${s}` : `‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ‡∏ø${s}`),
                hoverinfo: 'x+y+z+text'
            };

            const layoutPlotly = {
                margin: { l: 0, r: 0, b: 0, t: 0 },
                scene: {
                    xaxis: { title: lang === 'en' ? 'Income (THB)' : '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏ö‡∏≤‡∏ó)' },
                    yaxis: { title: lang === 'en' ? 'Draws/Month' : '‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' },
                    zaxis: { title: lang === 'en' ? 'Age' : '‡∏≠‡∏≤‡∏¢‡∏∏' },
                    camera: { eye: { x: 1.5, y: 1.5, z: 1.5 } }
                },
                plot_bgcolor: "rgba(0,0,0,0)", paper_bgcolor: "rgba(0,0,0,0)",
            };
            
            try {
                Plotly.newPlot('plotly3d', [trace1], layoutPlotly, {responsive: true, displayModeBar: false});
            } catch(e) { console.log("Plotly not loaded"); }
        }

        // --- GEMINI & UTILS ---
        
        async function callGemini(promptText) {
            // Check if API key is defined from config.js
            if (typeof apiKey === 'undefined' || !apiKey) {
                alert("API Key not found! Please check config.js.");
                return "Error: API Key missing.";
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(url, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: promptText }] }] })
                });
                if (!response.ok) throw new Error(response.status);
                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error(error);
                return currentLang === 'en' ? "Service unavailable. Please check your API key." : "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API Key ‡πÉ‡∏ô config.js";
            }
        }

        async function generateMarketInsight() {
            const btn = document.querySelector('button[onclick="generateMarketInsight()"]');
            const contentDiv = document.getElementById('market-insight-content');
            const originalBtnText = btn.innerHTML;
            btn.innerHTML = 'Analyzing...'; btn.disabled = true;
            contentDiv.innerHTML = '<div class="animate-pulse space-y-2"><div class="h-4 bg-gray-200 rounded w-3/4"></div><div class="h-4 bg-gray-200 rounded w-1/2"></div></div>';

            const langInstruction = currentLang === 'en' ? 'Answer in English.' : 'Answer in Thai language.';
            const prompt = `
                You are a senior data analyst for the Thai Lottery market. 
                Analyze these metrics: Market Share: Physical (65%), Official Digital (25%), Private Digital (10%). Growth Trend: Digital users growing 35% YoY.
                Provide 2 concise strategic insights. ${langInstruction}
            `;

            const result = await callGemini(prompt);
            contentDiv.innerHTML = marked.parse(result);
            btn.innerHTML = originalBtnText; btn.disabled = false;
        }

        async function interpretDream() {
            const input = document.getElementById('dreamInput').value;
            if (!input.trim()) return alert(currentLang === 'en' ? "Please describe your dream first!" : "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");

            const btn = document.getElementById('dreamBtn');
            const resultArea = document.getElementById('dreamResult');
            const contentDiv = document.getElementById('dreamContent');
            const originalBtnText = btn.innerHTML;
            
            btn.innerHTML = currentLang === 'en' ? 'üîÆ Consulting the Stars...' : 'üîÆ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...';
            btn.classList.add('opacity-75', 'cursor-not-allowed');
            
            const langInstruction = currentLang === 'en' ? 'Answer in English.' : 'Answer in Thai language.';
            const prompt = `
                You are a Thai Lottery "Dream Interpreter" expert (Mae Mor). User dreamt of: "${input}".
                Interpret this into "Lucky Numbers" based on Thai beliefs.
                Format as Markdown: **Interpretation**, **2-Digit Numbers**, **3-Digit Numbers**, **Advice**.
                ${langInstruction} Keep it mystical but friendly.
            `;

            const result = await callGemini(prompt);
            resultArea.classList.remove('hidden');
            contentDiv.innerHTML = marked.parse(result);
            btn.innerHTML = originalBtnText;
            btn.classList.remove('opacity-75', 'cursor-not-allowed');
        }

        function openDownloadModal() { document.getElementById('downloadModal').classList.remove('hidden'); }
        function closeDownloadModal() { document.getElementById('downloadModal').classList.add('hidden'); }
        
        async function generateRealPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFontSize(16); doc.setTextColor(30, 64, 175);
            doc.text("Thai Digital Lottery Market Report", 20, 20);
            doc.setFontSize(11); doc.setTextColor(0);
            doc.text("Note: This PDF is generated in English to ensure font compatibility.", 20, 30);
            doc.text("1. Executive Summary: Market value > 180 Billion THB, 35% Growth.", 20, 45);
            doc.save("Thai_Lottery_Market_Analysis_2025.pdf");
            setTimeout(closeDownloadModal, 500);
        }

        function downloadCSV() {
            const data = [['Category', 'Value'], ['Total Market', '180B'], ['Growth', '35%']];
            let csv = "data:text/csv;charset=utf-8," + data.map(e => e.join(",")).join("\n");
            const link = document.createElement("a");
            link.href = encodeURI(csv); link.download = "Raw_Data.csv";
            document.body.appendChild(link); link.click(); document.body.removeChild(link);
            setTimeout(closeDownloadModal, 500);
        }

        // Feature: Simulate Download of Uploaded Files
        function simulateDownload(filename) {
            const btn = event.currentTarget.querySelector('span:last-child');
            const originalText = btn.innerText;
            btn.innerText = 'Downloading...';
            
            setTimeout(() => {
                alert(`‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå: ${filename}\n(‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å Server ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)`);
                btn.innerText = originalText;
            }, 1000);
        }
    </script>
</body>
</html>
